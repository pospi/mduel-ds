<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>MDuel DS: C:/DevKitPro/!MDuel/source/spriteObject.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1-p1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="annotated.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<h1>C:/DevKitPro/!MDuel/source/spriteObject.cpp</h1><a href="sprite_object_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Marshmallow Duel DS v2</span>
<a name="l00003"></a>00003 <span class="comment"> * Copyright © 2007 Sam Pospischil http://pospi.spadgos.com</span>
<a name="l00004"></a>00004 <span class="comment"> * </span>
<a name="l00005"></a>00005 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
<a name="l00006"></a>00006 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
<a name="l00007"></a>00007 <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
<a name="l00008"></a>00008 <span class="comment"> * (at your option) any later version.</span>
<a name="l00009"></a>00009 <span class="comment"> * </span>
<a name="l00010"></a>00010 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
<a name="l00011"></a>00011 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="l00012"></a>00012 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span>
<a name="l00013"></a>00013 <span class="comment"> * GNU General Public License for more details.</span>
<a name="l00014"></a>00014 <span class="comment"> * </span>
<a name="l00015"></a>00015 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
<a name="l00016"></a>00016 <span class="comment"> * along with this program; if not, write to the Free Software</span>
<a name="l00017"></a>00017 <span class="comment"> * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA</span>
<a name="l00018"></a>00018 <span class="comment"> */</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="preprocessor">#include "<a class="code" href="sprite_object_8h.html">spriteObject.h</a>"</span>
<a name="l00021"></a>00021 
<a name="l00027"></a><a class="code" href="classsprite_object.html#8c84c9d6ff19a554e490fe55bf1d1382">00027</a> <a class="code" href="classsprite_object.html#8c84c9d6ff19a554e490fe55bf1d1382">spriteObject::spriteObject</a>(<a class="code" href="classsprite_manager.html">spriteManager</a> *newsm)
<a name="l00028"></a>00028         :  bNeedsGFXCleanup(false), attachment(NULL), isAttachment(false), staticSprite(false), sm(newsm), 
<a name="l00029"></a>00029         parentSprite(NULL), childSprite(NULL), spriteID(-1), palleteID(-1), gfxID(-1),
<a name="l00030"></a>00030                 #ifdef __WITHSOUND
<a name="l00031"></a>00031                 soundChannel(-1),
<a name="l00032"></a>00032                 #endif
<a name="l00033"></a>00033                 x(0), y(0), vx(0), vy(0), oldx(0), oldy(0), flippedh(false), flippedv(false),
<a name="l00034"></a>00034           oldFliph(false), oldFlipv(false), layer(0), frame(0), oldFrame(0), arbitraryAnim(0),
<a name="l00035"></a>00035           arbitrarySpeed(0), arbitraryFrameCounter(0), arbitraryTimeCounter(0), centerx(0),
<a name="l00036"></a>00036           centery(0), collision(COL_NONE), checkCollision(false), ignoreUntilUntouched(NULL), rotSetID(-1), 
<a name="l00037"></a>00037           rotAngle(0), bRotating(false), UPDATEDlayer(false), UPDATEDflip(false), framesToLive(-1)
<a name="l00038"></a>00038 {
<a name="l00039"></a>00039         <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#8993fc24a621a318912564c3fe638149">gameSprites</a>.push_back(<span class="keyword">this</span>);
<a name="l00040"></a>00040 <span class="preprocessor">        #ifdef __MDDEBUG</span>
<a name="l00041"></a>00041 <span class="preprocessor"></span>        className = <span class="stringliteral">"spriteObject"</span>;
<a name="l00042"></a>00042         <span class="keywordtype">char</span> buffer[255];
<a name="l00043"></a>00043         sprintf(buffer, <span class="stringliteral">"%d: constructed at gameSprites %d"</span>, <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#8993fc24a621a318912564c3fe638149">gameSprites</a>.size()-1);
<a name="l00044"></a>00044         macros::debugMessage(className, buffer);
<a name="l00045"></a>00045 <span class="preprocessor">        #endif</span>
<a name="l00046"></a>00046 <span class="preprocessor"></span>}
<a name="l00047"></a>00047 
<a name="l00051"></a><a class="code" href="classsprite_object.html#8de7b380bc3373fbbc075fe888719f62">00051</a> <a class="code" href="classsprite_object.html#8de7b380bc3373fbbc075fe888719f62">spriteObject::~spriteObject</a>()
<a name="l00052"></a>00052 {
<a name="l00053"></a>00053 <span class="preprocessor">        #ifdef __WITHSOUND</span>
<a name="l00054"></a>00054 <span class="preprocessor"></span>        <a class="code" href="classsprite_object.html#5459b17a49c6e423038c7178ab4a6dd0">stopSound</a>();
<a name="l00055"></a>00055 <span class="preprocessor">        #endif</span>
<a name="l00056"></a>00056 <span class="preprocessor"></span>        <a class="code" href="classsprite_object.html#f2f4e4a3fdae1930c9fb68c5108de29a">deleteSprite</a>();
<a name="l00057"></a>00057 }
<a name="l00058"></a>00058 
<a name="l00064"></a><a class="code" href="classsprite_object.html#b66cd0988a8e7af346272d95aba47f47">00064</a> <a class="code" href="classsprite_object.html#8c84c9d6ff19a554e490fe55bf1d1382">spriteObject::spriteObject</a>(<span class="keyword">const</span> <a class="code" href="classsprite_object.html">spriteObject</a> &amp;s)
<a name="l00065"></a>00065 {
<a name="l00066"></a>00066         <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a> = s.<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>;
<a name="l00067"></a>00067         <a class="code" href="classsprite_object.html#1ebc3125aa8da5949e3119025f6fbc2f">parentSprite</a> = s.<a class="code" href="classsprite_object.html#1ebc3125aa8da5949e3119025f6fbc2f">parentSprite</a>;
<a name="l00068"></a>00068         <a class="code" href="classsprite_object.html#7dcea86f2e14b1bbe8742a9a8d1211ea">childSprite</a> = s.<a class="code" href="classsprite_object.html#7dcea86f2e14b1bbe8742a9a8d1211ea">childSprite</a>;            <span class="comment">//perhaps childSprite and attachment should be freshly created?</span>
<a name="l00069"></a>00069         <a class="code" href="classsprite_object.html#0c60e2684cecb08156e796fed4abc4cd">attachment</a> = s.<a class="code" href="classsprite_object.html#0c60e2684cecb08156e796fed4abc4cd">attachment</a>;
<a name="l00070"></a>00070         <a class="code" href="classsprite_object.html#643b09104ce81cf1aa1dd81b86f2ee8a">ignoreUntilUntouched</a> = s.<a class="code" href="classsprite_object.html#643b09104ce81cf1aa1dd81b86f2ee8a">ignoreUntilUntouched</a>;
<a name="l00071"></a>00071         
<a name="l00072"></a>00072         <a class="code" href="classsprite_object.html#77bb45b9a8da08c8450517991189a8ab">bNeedsGFXCleanup</a> = s.<a class="code" href="classsprite_object.html#77bb45b9a8da08c8450517991189a8ab">bNeedsGFXCleanup</a>;
<a name="l00073"></a>00073         <a class="code" href="classsprite_object.html#c69ad4a82f52192ebb492946088199d3">isAttachment</a> = s.<a class="code" href="classsprite_object.html#c69ad4a82f52192ebb492946088199d3">isAttachment</a>;
<a name="l00074"></a>00074         <a class="code" href="classsprite_object.html#6cc8394c53dd60ec8e5286d27ac2183a">staticSprite</a> = s.<a class="code" href="classsprite_object.html#6cc8394c53dd60ec8e5286d27ac2183a">staticSprite</a>;
<a name="l00075"></a>00075         <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a> = s.<a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>;
<a name="l00076"></a>00076         <a class="code" href="classsprite_object.html#9c6b610f1930f17cac27c9cddb358ee7">palleteID</a> = s.<a class="code" href="classsprite_object.html#9c6b610f1930f17cac27c9cddb358ee7">palleteID</a>;
<a name="l00077"></a>00077         <a class="code" href="classsprite_object.html#7cc22253ab103ba351290e1f48a8cd44">gfxID</a> = s.<a class="code" href="classsprite_object.html#7cc22253ab103ba351290e1f48a8cd44">gfxID</a>;
<a name="l00078"></a>00078 <span class="preprocessor">        #ifdef __WITHSOUND</span>
<a name="l00079"></a>00079 <span class="preprocessor"></span>        <a class="code" href="classsprite_object.html#f6341f61a964f1f782d4e66a0d398dd0">soundChannel</a> = s.<a class="code" href="classsprite_object.html#f6341f61a964f1f782d4e66a0d398dd0">soundChannel</a>;
<a name="l00080"></a>00080 <span class="preprocessor">        #endif</span>
<a name="l00081"></a>00081 <span class="preprocessor"></span>        <a class="code" href="classsprite_object.html#d32183242a6b4215f28535d42f7b9c3d">x</a> = s.<a class="code" href="classsprite_object.html#d32183242a6b4215f28535d42f7b9c3d">x</a>; <a class="code" href="classsprite_object.html#51a72aa5cf4648b3d142431b46c46247">y</a> = s.<a class="code" href="classsprite_object.html#51a72aa5cf4648b3d142431b46c46247">y</a>; <a class="code" href="classsprite_object.html#4f1ae47c5993de56ed6e87dae90e3a8f">vx</a> = s.<a class="code" href="classsprite_object.html#4f1ae47c5993de56ed6e87dae90e3a8f">vx</a>; <a class="code" href="classsprite_object.html#f4a9d82ef326b94b3719ea8e6b73664e">vy</a> = s.<a class="code" href="classsprite_object.html#f4a9d82ef326b94b3719ea8e6b73664e">vy</a>; <a class="code" href="classsprite_object.html#5b34c8d5b28dd826009b1c32252af97e">oldx</a> = s.<a class="code" href="classsprite_object.html#5b34c8d5b28dd826009b1c32252af97e">oldx</a>; <a class="code" href="classsprite_object.html#8fea6697731e85a4bead61a51369eaaa">oldy</a> = s.<a class="code" href="classsprite_object.html#8fea6697731e85a4bead61a51369eaaa">oldy</a>;
<a name="l00082"></a>00082         <a class="code" href="classsprite_object.html#ef3fdb67169b59c2893e887ed2560040">flippedh</a> = s.<a class="code" href="classsprite_object.html#ef3fdb67169b59c2893e887ed2560040">flippedh</a>; <a class="code" href="classsprite_object.html#f290204b7226bc2f9720161fc094a24b">flippedv</a> = s.<a class="code" href="classsprite_object.html#f290204b7226bc2f9720161fc094a24b">flippedv</a>; <a class="code" href="classsprite_object.html#4f65a615dbbfe356a6dd80d646df11e3">oldFliph</a> = s.<a class="code" href="classsprite_object.html#4f65a615dbbfe356a6dd80d646df11e3">oldFliph</a>; <a class="code" href="classsprite_object.html#de57316618f94deb5ac15dbb1c035399">oldFlipv</a> = s.<a class="code" href="classsprite_object.html#de57316618f94deb5ac15dbb1c035399">oldFlipv</a>;
<a name="l00083"></a>00083         <a class="code" href="classsprite_object.html#ad650a239c91615dbd0b4eee02be5ac5">layer</a> = s.<a class="code" href="classsprite_object.html#ad650a239c91615dbd0b4eee02be5ac5">layer</a>; <a class="code" href="classsprite_object.html#3d250c9ad97a81b5dbeef79991eea9e7">frame</a> = s.<a class="code" href="classsprite_object.html#3d250c9ad97a81b5dbeef79991eea9e7">frame</a>; <a class="code" href="classsprite_object.html#f00db6e3f733f0cf6af5969fbcb81626">oldFrame</a> = s.<a class="code" href="classsprite_object.html#f00db6e3f733f0cf6af5969fbcb81626">oldFrame</a>;
<a name="l00084"></a>00084         <a class="code" href="classsprite_object.html#332476a1f70f1bb9221936080cd7d3c0">arbitraryAnim</a> = s.<a class="code" href="classsprite_object.html#332476a1f70f1bb9221936080cd7d3c0">arbitraryAnim</a>; <a class="code" href="classsprite_object.html#7b44a1a7b59eb0c0d0d6425a6d4c95f6">arbitrarySpeed</a> = s.<a class="code" href="classsprite_object.html#7b44a1a7b59eb0c0d0d6425a6d4c95f6">arbitrarySpeed</a>;
<a name="l00085"></a>00085         <a class="code" href="classsprite_object.html#8e0fff047faac5c16bd26e71f3332d7f">arbitraryFrameCounter</a> = s.<a class="code" href="classsprite_object.html#8e0fff047faac5c16bd26e71f3332d7f">arbitraryFrameCounter</a>; <a class="code" href="classsprite_object.html#3c7175c1a01af7785b31e432a46bba7e">arbitraryTimeCounter</a> = s.<a class="code" href="classsprite_object.html#3c7175c1a01af7785b31e432a46bba7e">arbitraryTimeCounter</a>;
<a name="l00086"></a>00086         <a class="code" href="classsprite_object.html#8a42d1e5ef00fb1968eda24bbc5e05d5">centerx</a> = s.<a class="code" href="classsprite_object.html#8a42d1e5ef00fb1968eda24bbc5e05d5">centerx</a>; <a class="code" href="classsprite_object.html#370dd17954cde6b12ec0469f03827d6f">centery</a> = s.<a class="code" href="classsprite_object.html#370dd17954cde6b12ec0469f03827d6f">centery</a>; <a class="code" href="classsprite_object.html#3ae1bdb1e417477fa6aa7849993ff3a2">collision</a> = s.<a class="code" href="classsprite_object.html#3ae1bdb1e417477fa6aa7849993ff3a2">collision</a>;
<a name="l00087"></a>00087         <a class="code" href="classsprite_object.html#cfa1e380339eb546e5b188e088e8b7ec">checkCollision</a> = s.<a class="code" href="classsprite_object.html#cfa1e380339eb546e5b188e088e8b7ec">checkCollision</a>;
<a name="l00088"></a>00088         <a class="code" href="classsprite_object.html#b5e73e1a45286bf90ebadc81fc4d32d4">rotSetID</a> = s.<a class="code" href="classsprite_object.html#b5e73e1a45286bf90ebadc81fc4d32d4">rotSetID</a>; <a class="code" href="classsprite_object.html#ce33841bee3161423ef4240ed189bb59">rotAngle</a> = s.<a class="code" href="classsprite_object.html#ce33841bee3161423ef4240ed189bb59">rotAngle</a>; <a class="code" href="classsprite_object.html#ea71dc15fac465788a27eb5f0e407b6d">bRotating</a> = s.<a class="code" href="classsprite_object.html#ea71dc15fac465788a27eb5f0e407b6d">bRotating</a>;
<a name="l00089"></a>00089         <a class="code" href="classsprite_object.html#7ede5b5fe4d3fbe94be0ed62727951f2">UPDATEDlayer</a> = s.<a class="code" href="classsprite_object.html#7ede5b5fe4d3fbe94be0ed62727951f2">UPDATEDlayer</a>; <a class="code" href="classsprite_object.html#a66c224f6865cffffef4117e769808d8">UPDATEDflip</a> = s.<a class="code" href="classsprite_object.html#a66c224f6865cffffef4117e769808d8">UPDATEDflip</a>;
<a name="l00090"></a>00090         <a class="code" href="classsprite_object.html#2013e69ace8f9449a2aca34718aee68e">framesToLive</a> = s.<a class="code" href="classsprite_object.html#2013e69ace8f9449a2aca34718aee68e">framesToLive</a>;
<a name="l00091"></a>00091 }
<a name="l00092"></a>00092 
<a name="l00109"></a><a class="code" href="classsprite_object.html#cc40da98b5fc5fd55f12abd9ad7b7ca7">00109</a> s8 <a class="code" href="classsprite_object.html#cc40da98b5fc5fd55f12abd9ad7b7ca7">spriteObject::giveSprite</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *spriteData, u8 sizex, u8 sizey, u8 cx, u8 cy, u8 minIndex,  s16 nx, s16 ny, u8 colorMode)
<a name="l00110"></a>00110 {
<a name="l00111"></a>00111         <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#9c6b610f1930f17cac27c9cddb358ee7">palleteID</a> == -1) {
<a name="l00112"></a>00112 <span class="preprocessor">                #ifdef __MDDEBUG</span>
<a name="l00113"></a>00113 <span class="preprocessor"></span>                macros::debugMessage(ERRTEXT, <span class="stringliteral">"giveSprite() but no pal!"</span>, ERRORPOS);
<a name="l00114"></a>00114 <span class="preprocessor">                #endif</span>
<a name="l00115"></a>00115 <span class="preprocessor"></span>                <span class="keywordflow">return</span> -1;
<a name="l00116"></a>00116         }
<a name="l00117"></a>00117         
<a name="l00118"></a>00118         <span class="comment">//sprites are always created at OFFX,OFFY and then moved afterwards to prevent flickering.</span>
<a name="l00119"></a>00119         
<a name="l00120"></a>00120 <span class="preprocessor">        #ifdef __MDDEBUG</span>
<a name="l00121"></a>00121 <span class="preprocessor"></span>        <span class="keywordtype">char</span> buffer[255];
<a name="l00122"></a>00122         sprintf(buffer, <span class="stringliteral">"%d: attempting to get raw sprite"</span>, <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>);
<a name="l00123"></a>00123         macros::debugMessage(className, buffer);
<a name="l00124"></a>00124 <span class="preprocessor">        #endif</span>
<a name="l00125"></a>00125 <span class="preprocessor"></span>        <span class="comment">//lets try this a new way...</span>
<a name="l00126"></a>00126         <a class="code" href="classsprite_object.html#7cc22253ab103ba351290e1f48a8cd44">gfxID</a> = <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#b7df2ca5c66648777ceda3f9584fee1b">loadGFX</a>(spriteData, sizex, sizey, colorMode);
<a name="l00127"></a>00127         <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a> = <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#eda81f0f2a2832c2e8442d57f2315b84">loadSpriteFromGFX</a>(<a class="code" href="classsprite_object.html#7cc22253ab103ba351290e1f48a8cd44">gfxID</a>, sizex, sizey, <a class="code" href="classsprite_object.html#9c6b610f1930f17cac27c9cddb358ee7">palleteID</a>, minIndex, colorMode, <a class="code" href="macros_8h.html#89f0c1c432db05617bff0b47c4e158a9">OFFX</a>, <a class="code" href="macros_8h.html#59c7ae9289144fac2bce9b84dd893dd6">OFFY</a>);
<a name="l00128"></a>00128         <a class="code" href="classsprite_object.html#77bb45b9a8da08c8450517991189a8ab">bNeedsGFXCleanup</a> = <span class="keyword">true</span>;
<a name="l00129"></a>00129 
<a name="l00130"></a>00130 <span class="preprocessor">        #ifdef __MDDEBUG</span>
<a name="l00131"></a>00131 <span class="preprocessor"></span>        memset(buffer, 0, 255);
<a name="l00132"></a>00132         sprintf(buffer, <span class="stringliteral">"%d: raw sprite given (gfx #%d, sprite #%d)"</span>, <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#7cc22253ab103ba351290e1f48a8cd44">gfxID</a>, <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>);
<a name="l00133"></a>00133         macros::debugMessage(className, buffer);
<a name="l00134"></a>00134 <span class="preprocessor">        #endif</span>
<a name="l00135"></a>00135 <span class="preprocessor"></span>        
<a name="l00136"></a>00136         <span class="comment">//spriteID = sm-&gt;loadSprite(spriteData, sizex, sizey, minIndex, palleteID, OFFX, OFFY, colorMode);</span>
<a name="l00137"></a>00137         
<a name="l00138"></a>00138         <a class="code" href="classsprite_object.html#8a42d1e5ef00fb1968eda24bbc5e05d5">centerx</a> = cx;
<a name="l00139"></a>00139         <a class="code" href="classsprite_object.html#370dd17954cde6b12ec0469f03827d6f">centery</a> = cy;
<a name="l00140"></a>00140         <a class="code" href="classsprite_object.html#68a7fdfe600c71658d1a192b2685c7b0">setPos</a>(nx, ny);
<a name="l00141"></a>00141         <span class="keywordflow">return</span> <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>;
<a name="l00142"></a>00142 }
<a name="l00143"></a>00143 
<a name="l00151"></a><a class="code" href="classsprite_object.html#0ae90648ee90d2a1681ab10b45dc38e2">00151</a> s8 <a class="code" href="classsprite_object.html#0ae90648ee90d2a1681ab10b45dc38e2">spriteObject::givePallete</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> *palleteData)
<a name="l00152"></a>00152 {
<a name="l00153"></a>00153 <span class="preprocessor">        #ifdef __MDDEBUG</span>
<a name="l00154"></a>00154 <span class="preprocessor"></span>        <span class="keywordtype">char</span> buffer[255];
<a name="l00155"></a>00155         sprintf(buffer, <span class="stringliteral">"%d: attempting to get raw pallete"</span>, <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>);
<a name="l00156"></a>00156         macros::debugMessage(className, buffer);
<a name="l00157"></a>00157 <span class="preprocessor">        #endif</span>
<a name="l00158"></a>00158 <span class="preprocessor"></span>        <a class="code" href="classsprite_object.html#9c6b610f1930f17cac27c9cddb358ee7">palleteID</a> = <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#fc39fd58535e3ab910effadb05babba6">loadPallete</a>((<span class="keywordtype">void</span>*)palleteData);
<a name="l00159"></a>00159 <span class="preprocessor">        #ifdef __MDDEBUG</span>
<a name="l00160"></a>00160 <span class="preprocessor"></span>        memset(buffer, 0, 255);
<a name="l00161"></a>00161         sprintf(buffer, <span class="stringliteral">"%d: raw pallete given (#%d)"</span>, <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#9c6b610f1930f17cac27c9cddb358ee7">palleteID</a>);
<a name="l00162"></a>00162         macros::debugMessage(className, buffer);
<a name="l00163"></a>00163 <span class="preprocessor">        #endif</span>
<a name="l00164"></a>00164 <span class="preprocessor"></span>        <span class="keywordflow">return</span> <a class="code" href="classsprite_object.html#9c6b610f1930f17cac27c9cddb358ee7">palleteID</a>;
<a name="l00165"></a>00165 }
<a name="l00166"></a>00166 
<a name="l00177"></a><a class="code" href="classsprite_object.html#c0e984d302bf576ce0e0566f6d6f982f">00177</a> <span class="keywordtype">bool</span> <a class="code" href="classsprite_object.html#c0e984d302bf576ce0e0566f6d6f982f">spriteObject::updatePallete</a>(s8 newPalID, u8 sizex, u8 sizey, u8 colorMode)
<a name="l00178"></a>00178 {
<a name="l00179"></a>00179 <span class="preprocessor">        #ifdef __MDDEBUG</span>
<a name="l00180"></a>00180 <span class="preprocessor"></span>        <span class="keywordtype">char</span> buffer[255];
<a name="l00181"></a>00181         sprintf(buffer, <span class="stringliteral">"%d: attempting pallete update (#%d -&gt; #%d)"</span>, <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#9c6b610f1930f17cac27c9cddb358ee7">palleteID</a>, newPalID);
<a name="l00182"></a>00182         macros::debugMessage(className, buffer);
<a name="l00183"></a>00183 <span class="preprocessor">        #endif</span>
<a name="l00184"></a>00184 <span class="preprocessor"></span>        <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#7cc22253ab103ba351290e1f48a8cd44">gfxID</a> != -1 &amp;&amp; <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a> != -1 &amp;&amp; newPalID != -1)
<a name="l00185"></a>00185         {
<a name="l00186"></a>00186                 <a class="code" href="classsprite_object.html#9c6b610f1930f17cac27c9cddb358ee7">palleteID</a> = newPalID;
<a name="l00187"></a>00187                 <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#48a967f4d8b79968789c3cd877df3820">updateSpritePallete</a>(<a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>, <a class="code" href="classsprite_object.html#7cc22253ab103ba351290e1f48a8cd44">gfxID</a>, newPalID, sizex, sizey, colorMode, <a class="code" href="classsprite_object.html#d32183242a6b4215f28535d42f7b9c3d">x</a>&gt;&gt;8, <a class="code" href="classsprite_object.html#51a72aa5cf4648b3d142431b46c46247">y</a>&gt;&gt;8);
<a name="l00188"></a>00188                 <a class="code" href="classsprite_object.html#a66c224f6865cffffef4117e769808d8">UPDATEDflip</a> = <span class="keyword">true</span>;             <span class="comment">//giving a new pallete resets the GFX</span>
<a name="l00189"></a>00189                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00190"></a>00190         }
<a name="l00191"></a>00191         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00192"></a>00192 }
<a name="l00193"></a>00193 
<a name="l00210"></a><a class="code" href="classsprite_object.html#3fedeb454aa5973df6cd5f6b0862710b">00210</a> s8 <a class="code" href="classsprite_object.html#3fedeb454aa5973df6cd5f6b0862710b">spriteObject::giveGFX</a>(u16 GFXid, u8 sizex, u8 sizey, u8 cx, u8 cy, u8 minIndex, s16 nx, s16 ny, u8 colorMode)
<a name="l00211"></a>00211 {
<a name="l00212"></a>00212 <span class="preprocessor">        #ifdef __MDDEBUG</span>
<a name="l00213"></a>00213 <span class="preprocessor"></span>        <span class="keywordtype">char</span> buffer[255];
<a name="l00214"></a>00214         sprintf(buffer, <span class="stringliteral">"%d: attempting to get preloaded GFX"</span>, <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>);
<a name="l00215"></a>00215         macros::debugMessage(className, buffer);
<a name="l00216"></a>00216 <span class="preprocessor">        #endif</span>
<a name="l00217"></a>00217 <span class="preprocessor"></span>        <a class="code" href="classsprite_object.html#7cc22253ab103ba351290e1f48a8cd44">gfxID</a> = GFXid;
<a name="l00218"></a>00218         <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a> = <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#eda81f0f2a2832c2e8442d57f2315b84">loadSpriteFromGFX</a>(GFXid, sizex, sizey, <a class="code" href="classsprite_object.html#9c6b610f1930f17cac27c9cddb358ee7">palleteID</a>, minIndex, colorMode, <a class="code" href="macros_8h.html#89f0c1c432db05617bff0b47c4e158a9">OFFX</a>, <a class="code" href="macros_8h.html#59c7ae9289144fac2bce9b84dd893dd6">OFFY</a>);
<a name="l00219"></a>00219 <span class="preprocessor">        #ifdef __MDDEBUG</span>
<a name="l00220"></a>00220 <span class="preprocessor"></span>        memset(buffer, 0, 255);
<a name="l00221"></a>00221         sprintf(buffer, <span class="stringliteral">"%d: preloaded GFX given (gfx #%d, sprite #%d)"</span>, <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#7cc22253ab103ba351290e1f48a8cd44">gfxID</a>, <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>);
<a name="l00222"></a>00222         macros::debugMessage(className, buffer);
<a name="l00223"></a>00223 <span class="preprocessor">        #endif</span>
<a name="l00224"></a>00224 <span class="preprocessor"></span>        <a class="code" href="classsprite_object.html#8a42d1e5ef00fb1968eda24bbc5e05d5">centerx</a> = cx;
<a name="l00225"></a>00225         <a class="code" href="classsprite_object.html#370dd17954cde6b12ec0469f03827d6f">centery</a> = cy;
<a name="l00226"></a>00226         <a class="code" href="classsprite_object.html#68a7fdfe600c71658d1a192b2685c7b0">setPos</a>(nx, ny);
<a name="l00227"></a>00227         <span class="keywordflow">return</span> <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>;
<a name="l00228"></a>00228 }
<a name="l00229"></a>00229 
<a name="l00241"></a><a class="code" href="classsprite_object.html#f2f4e4a3fdae1930c9fb68c5108de29a">00241</a> <span class="keywordtype">void</span> <a class="code" href="classsprite_object.html#f2f4e4a3fdae1930c9fb68c5108de29a">spriteObject::deleteSprite</a>()
<a name="l00242"></a>00242 {       
<a name="l00243"></a>00243 <span class="preprocessor">        #ifdef __MDDEBUG</span>
<a name="l00244"></a>00244 <span class="preprocessor"></span>        <span class="keywordtype">char</span> buffer[255];
<a name="l00245"></a>00245         sprintf(buffer, <span class="stringliteral">"%d: deleting (gfx #%d, sprite #%d, pallete #%d)"</span>, <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#7cc22253ab103ba351290e1f48a8cd44">gfxID</a>, <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>, <a class="code" href="classsprite_object.html#9c6b610f1930f17cac27c9cddb358ee7">palleteID</a>);
<a name="l00246"></a>00246         macros::debugMessage(className, buffer);
<a name="l00247"></a>00247 <span class="preprocessor">        #endif</span>
<a name="l00248"></a>00248 <span class="preprocessor"></span>        
<a name="l00249"></a>00249         PA_StopSpriteAnim(<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#5b7652fbbb7a0f8449bc3bd2655d1b97">getSpriteID</a>());
<a name="l00250"></a>00250         PA_SetSpriteXY(<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#5b7652fbbb7a0f8449bc3bd2655d1b97">getSpriteID</a>(), <a class="code" href="macros_8h.html#89f0c1c432db05617bff0b47c4e158a9">OFFX</a>, <a class="code" href="macros_8h.html#59c7ae9289144fac2bce9b84dd893dd6">OFFY</a>);
<a name="l00251"></a>00251         
<a name="l00252"></a>00252         <span class="comment">//this stuff isnt necessary if the entire sprite system is resetting</span>
<a name="l00253"></a>00253         <span class="keywordflow">if</span> (!<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#737550c34c285e8fc2b32e31fa845533">isResetting</a>())
<a name="l00254"></a>00254         {
<a name="l00255"></a>00255                 <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#77bb45b9a8da08c8450517991189a8ab">bNeedsGFXCleanup</a>)
<a name="l00256"></a>00256                         PA_DeleteGfx(<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#a0148bc6ed77ecec3054fba6b84edef4">getGFXid</a>());
<a name="l00257"></a>00257                 <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#8270490df60feb41abefba30e0a4f298">hasGraphics</a>())
<a name="l00258"></a>00258                         <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#ddc96a11924cb1b5ff6277dceedb95a6">removeSprite</a>(<a class="code" href="classsprite_object.html#5b7652fbbb7a0f8449bc3bd2655d1b97">getSpriteID</a>());
<a name="l00259"></a>00259                 
<a name="l00260"></a>00260                 <span class="comment">//if (parentSprite != NULL)</span>
<a name="l00261"></a>00261                 <span class="comment">//      parentSprite-&gt;removeChild(this);</span>
<a name="l00262"></a>00262                 
<a name="l00263"></a>00263 <span class="preprocessor">                #ifdef __MDDEBUG</span>
<a name="l00264"></a>00264 <span class="preprocessor"></span>                memset(buffer, 0, 255);
<a name="l00265"></a>00265                 sprintf(buffer, <span class="stringliteral">"%d: clearChildren"</span>, <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>);
<a name="l00266"></a>00266                 macros::debugMessage(className, buffer);
<a name="l00267"></a>00267 <span class="preprocessor">                #endif</span>
<a name="l00268"></a>00268 <span class="preprocessor"></span>
<a name="l00269"></a>00269                 <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#7dcea86f2e14b1bbe8742a9a8d1211ea">childSprite</a> != NULL)
<a name="l00270"></a>00270                         <a class="code" href="classsprite_object.html#7dcea86f2e14b1bbe8742a9a8d1211ea">childSprite</a>-&gt;<a class="code" href="classsprite_object.html#65673241d90a443a410a201004396f43">destroy</a>();
<a name="l00271"></a>00271                 <a class="code" href="classsprite_object.html#7dcea86f2e14b1bbe8742a9a8d1211ea">childSprite</a> = NULL;
<a name="l00272"></a>00272                 
<a name="l00273"></a>00273                 <span class="comment">//TODO: this method of deletion requires that children be created after parents</span>
<a name="l00274"></a>00274                 <span class="comment">/*if (!childSprites.empty())</span>
<a name="l00275"></a>00275 <span class="comment">                {</span>
<a name="l00276"></a>00276 <span class="comment">                        vector&lt;spriteObject*&gt;::iterator it = childSprites.begin();</span>
<a name="l00277"></a>00277 <span class="comment">                        while ( it != childSprites.end() )</span>
<a name="l00278"></a>00278 <span class="comment">                        {</span>
<a name="l00279"></a>00279 <span class="comment">                                if (*it != NULL)</span>
<a name="l00280"></a>00280 <span class="comment">                                {</span>
<a name="l00281"></a>00281 <span class="comment">                                        (*it)-&gt;destroy();</span>
<a name="l00282"></a>00282 <span class="comment">                                }</span>
<a name="l00283"></a>00283 <span class="comment">                                #ifdef __MDDEBUG</span>
<a name="l00284"></a>00284 <span class="comment">                                else</span>
<a name="l00285"></a>00285 <span class="comment">                                        macros::debugMessage(ERRTEXT, "NULL childSprite found", ERRORPOS);</span>
<a name="l00286"></a>00286 <span class="comment">                                #endif</span>
<a name="l00287"></a>00287 <span class="comment">                                ++it;</span>
<a name="l00288"></a>00288 <span class="comment">                        }</span>
<a name="l00289"></a>00289 <span class="comment">                        childSprites.clear();</span>
<a name="l00290"></a>00290 <span class="comment">                }*/</span>
<a name="l00291"></a>00291         }
<a name="l00292"></a>00292         
<a name="l00293"></a>00293 <span class="preprocessor">        #ifdef __MDDEBUG</span>
<a name="l00294"></a>00294 <span class="preprocessor"></span>        memset(buffer, 0, 255);
<a name="l00295"></a>00295         sprintf(buffer, <span class="stringliteral">"%d: deleteSprite[end]"</span>, <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>);
<a name="l00296"></a>00296         macros::debugMessage(className, buffer);
<a name="l00297"></a>00297 <span class="preprocessor">        #endif</span>
<a name="l00298"></a>00298 <span class="preprocessor"></span>}
<a name="l00299"></a>00299 
<a name="l00305"></a><a class="code" href="classsprite_object.html#8270490df60feb41abefba30e0a4f298">00305</a> <span class="keywordtype">bool</span> <a class="code" href="classsprite_object.html#8270490df60feb41abefba30e0a4f298">spriteObject::hasGraphics</a>()<span class="keyword"> const</span>
<a name="l00306"></a>00306 <span class="keyword"></span>{
<a name="l00307"></a>00307         <span class="keywordflow">return</span> (<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#edc433dc4a21d0a5f5d56afa2be93011">isSprite</a>(<a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>));
<a name="l00308"></a>00308 }
<a name="l00309"></a>00309 
<a name="l00316"></a><a class="code" href="classsprite_object.html#30b86fcea88aef923e414df5d119d9af">00316</a> <span class="keywordtype">void</span> <a class="code" href="classsprite_object.html#30b86fcea88aef923e414df5d119d9af">spriteObject::updateSprite</a>()
<a name="l00317"></a>00317 {
<a name="l00318"></a>00318         <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#8270490df60feb41abefba30e0a4f298">hasGraphics</a>())
<a name="l00319"></a>00319         {
<a name="l00320"></a>00320                 <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#c69ad4a82f52192ebb492946088199d3">isAttachment</a> &amp;&amp; <a class="code" href="classsprite_object.html#1ebc3125aa8da5949e3119025f6fbc2f">parentSprite</a> != NULL)
<a name="l00321"></a>00321                         <a class="code" href="classsprite_object.html#3194f6e83976878edfc01f24faaf6390">setFrame</a>(<a class="code" href="classsprite_object.html#1ebc3125aa8da5949e3119025f6fbc2f">parentSprite</a>-&gt;<a class="code" href="classsprite_object.html#5ba9a49407d561228b842b7996025351">getFrame</a>());
<a name="l00322"></a>00322                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#332476a1f70f1bb9221936080cd7d3c0">arbitraryAnim</a> != 0)
<a name="l00323"></a>00323                 {
<a name="l00324"></a>00324                         <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#3c7175c1a01af7785b31e432a46bba7e">arbitraryTimeCounter</a> == 0)
<a name="l00325"></a>00325                         {
<a name="l00326"></a>00326                                 <a class="code" href="classsprite_object.html#3d250c9ad97a81b5dbeef79991eea9e7">frame</a> = <a class="code" href="classsprite_object.html#d154edb645ce1103b6e42cd13036660d">arbFrames</a>[<a class="code" href="classsprite_object.html#8e0fff047faac5c16bd26e71f3332d7f">arbitraryFrameCounter</a>];
<a name="l00327"></a>00327                                 ++<a class="code" href="classsprite_object.html#8e0fff047faac5c16bd26e71f3332d7f">arbitraryFrameCounter</a>;
<a name="l00328"></a>00328                         }
<a name="l00329"></a>00329                         ++<a class="code" href="classsprite_object.html#3c7175c1a01af7785b31e432a46bba7e">arbitraryTimeCounter</a>;
<a name="l00330"></a>00330                         <a class="code" href="classsprite_object.html#3c7175c1a01af7785b31e432a46bba7e">arbitraryTimeCounter</a> %= <a class="code" href="classsprite_object.html#7b44a1a7b59eb0c0d0d6425a6d4c95f6">arbitrarySpeed</a>;
<a name="l00331"></a>00331                         <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#8e0fff047faac5c16bd26e71f3332d7f">arbitraryFrameCounter</a> == <a class="code" href="classsprite_object.html#d154edb645ce1103b6e42cd13036660d">arbFrames</a>.size())
<a name="l00332"></a>00332                         {
<a name="l00333"></a>00333                                 <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#332476a1f70f1bb9221936080cd7d3c0">arbitraryAnim</a> != 2)
<a name="l00334"></a>00334                                         <a class="code" href="classsprite_object.html#332476a1f70f1bb9221936080cd7d3c0">arbitraryAnim</a> = 0;      <span class="comment">//only played once, so stop animation and break out</span>
<a name="l00335"></a>00335                                 <span class="keywordflow">else</span>
<a name="l00336"></a>00336                                         <a class="code" href="classsprite_object.html#8e0fff047faac5c16bd26e71f3332d7f">arbitraryFrameCounter</a> = 0;
<a name="l00337"></a>00337                         }
<a name="l00338"></a>00338                 }
<a name="l00339"></a>00339                 
<a name="l00340"></a>00340                 <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#f00db6e3f733f0cf6af5969fbcb81626">oldFrame</a> != <a class="code" href="classsprite_object.html#3d250c9ad97a81b5dbeef79991eea9e7">frame</a>)
<a name="l00341"></a>00341                 {
<a name="l00342"></a>00342                         PA_SetSpriteAnim(<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>, <a class="code" href="classsprite_object.html#3d250c9ad97a81b5dbeef79991eea9e7">frame</a>);
<a name="l00343"></a>00343                         <a class="code" href="classsprite_object.html#f00db6e3f733f0cf6af5969fbcb81626">oldFrame</a> = <a class="code" href="classsprite_object.html#3d250c9ad97a81b5dbeef79991eea9e7">frame</a>;
<a name="l00344"></a>00344                 }
<a name="l00345"></a>00345         }
<a name="l00346"></a>00346         
<a name="l00347"></a>00347         <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#6cc8394c53dd60ec8e5286d27ac2183a">staticSprite</a>)
<a name="l00348"></a>00348                 <span class="keywordflow">return</span>;
<a name="l00349"></a>00349         <a class="code" href="classsprite_object.html#d32183242a6b4215f28535d42f7b9c3d">x</a> += <a class="code" href="classsprite_object.html#4f1ae47c5993de56ed6e87dae90e3a8f">vx</a>;        <span class="comment">//take speed into account</span>
<a name="l00350"></a>00350         <a class="code" href="classsprite_object.html#51a72aa5cf4648b3d142431b46c46247">y</a> += <a class="code" href="classsprite_object.html#f4a9d82ef326b94b3719ea8e6b73664e">vy</a>;
<a name="l00351"></a>00351         
<a name="l00352"></a>00352         <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#8270490df60feb41abefba30e0a4f298">hasGraphics</a>())      <span class="comment">//if this is an invisible sprite then we only really care about its position vars</span>
<a name="l00353"></a>00353         {
<a name="l00354"></a>00354                 <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#1ebc3125aa8da5949e3119025f6fbc2f">parentSprite</a> != NULL)
<a name="l00355"></a>00355                 {
<a name="l00356"></a>00356                         <span class="comment">//TODO! this actually depends on the order sprites are created, which is BAD!</span>
<a name="l00357"></a>00357                         <span class="comment">//however, given that I never plan on making hierachies of more than 2, probably doesn't matter.</span>
<a name="l00358"></a>00358                         <a class="code" href="classsprite_object.html#9986cf3403d93accf99d23f2b73675b0">setFlipped</a>(<a class="code" href="classsprite_object.html#1ebc3125aa8da5949e3119025f6fbc2f">parentSprite</a>-&gt;<a class="code" href="classsprite_object.html#ef3fdb67169b59c2893e887ed2560040">flippedh</a>, <a class="code" href="classsprite_object.html#1ebc3125aa8da5949e3119025f6fbc2f">parentSprite</a>-&gt;<a class="code" href="classsprite_object.html#f290204b7226bc2f9720161fc094a24b">flippedv</a>);
<a name="l00359"></a>00359                         s16 extrax = 0, extray = 0;
<a name="l00360"></a>00360                         <span class="keywordflow">for</span> (<a class="code" href="classsprite_object.html">spriteObject</a> *i = <span class="keyword">this</span>; i != NULL; i = i-&gt;parentSprite)
<a name="l00361"></a>00361                         {
<a name="l00362"></a>00362                                 <span class="keywordflow">if</span> (i-&gt;parentSprite == NULL)
<a name="l00363"></a>00363                                 {
<a name="l00364"></a>00364                                         extrax += i-&gt;getx();
<a name="l00365"></a>00365                                         extray += i-&gt;gety();
<a name="l00366"></a>00366                                 } <span class="keywordflow">else</span> {
<a name="l00367"></a>00367                                         extrax += (i-&gt;parentSprite-&gt;flippedh ? i-&gt;getx()*-1 : i-&gt;getx());
<a name="l00368"></a>00368                                         extray += (i-&gt;parentSprite-&gt;flippedv ? i-&gt;gety()*-1 : i-&gt;gety());
<a name="l00369"></a>00369                                 }
<a name="l00370"></a>00370                         }
<a name="l00371"></a>00371                         PA_SetSpriteXY(<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>, extrax-<a class="code" href="classsprite_object.html#8a42d1e5ef00fb1968eda24bbc5e05d5">centerx</a>, extray-<a class="code" href="classsprite_object.html#370dd17954cde6b12ec0469f03827d6f">centery</a>);
<a name="l00372"></a>00372                 }
<a name="l00373"></a>00373                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#d32183242a6b4215f28535d42f7b9c3d">x</a> != <a class="code" href="classsprite_object.html#5b34c8d5b28dd826009b1c32252af97e">oldx</a> || <a class="code" href="classsprite_object.html#51a72aa5cf4648b3d142431b46c46247">y</a> != <a class="code" href="classsprite_object.html#8fea6697731e85a4bead61a51369eaaa">oldy</a>)
<a name="l00374"></a>00374                 {
<a name="l00375"></a>00375                         PA_SetSpriteXY(<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>, (<a class="code" href="classsprite_object.html#d32183242a6b4215f28535d42f7b9c3d">x</a>&gt;&gt;8), (<a class="code" href="classsprite_object.html#51a72aa5cf4648b3d142431b46c46247">y</a>&gt;&gt;8));   <span class="comment">//use center as registration point</span>
<a name="l00376"></a>00376                         <a class="code" href="classsprite_object.html#5b34c8d5b28dd826009b1c32252af97e">oldx</a> = <a class="code" href="classsprite_object.html#d32183242a6b4215f28535d42f7b9c3d">x</a>;
<a name="l00377"></a>00377                         <a class="code" href="classsprite_object.html#8fea6697731e85a4bead61a51369eaaa">oldy</a> = <a class="code" href="classsprite_object.html#51a72aa5cf4648b3d142431b46c46247">y</a>;
<a name="l00378"></a>00378                 }
<a name="l00379"></a>00379                 
<a name="l00380"></a>00380                 <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#a66c224f6865cffffef4117e769808d8">UPDATEDflip</a>)
<a name="l00381"></a>00381                 {
<a name="l00382"></a>00382                         PA_SetSpriteHflip(<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>, <a class="code" href="classsprite_object.html#ef3fdb67169b59c2893e887ed2560040">flippedh</a>);
<a name="l00383"></a>00383                         PA_SetSpriteVflip(<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>, <a class="code" href="classsprite_object.html#f290204b7226bc2f9720161fc094a24b">flippedv</a>);
<a name="l00384"></a>00384                         <a class="code" href="classsprite_object.html#a66c224f6865cffffef4117e769808d8">UPDATEDflip</a> = <span class="keyword">false</span>;
<a name="l00385"></a>00385                 }
<a name="l00386"></a>00386                 
<a name="l00387"></a>00387                 <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#7ede5b5fe4d3fbe94be0ed62727951f2">UPDATEDlayer</a>)
<a name="l00388"></a>00388                 {
<a name="l00389"></a>00389                         PA_SetSpritePrio(<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>, <a class="code" href="classsprite_object.html#ad650a239c91615dbd0b4eee02be5ac5">layer</a>);
<a name="l00390"></a>00390                         <a class="code" href="classsprite_object.html#7ede5b5fe4d3fbe94be0ed62727951f2">UPDATEDlayer</a> = <span class="keyword">false</span>;
<a name="l00391"></a>00391                 }
<a name="l00392"></a>00392                 
<a name="l00393"></a>00393                 <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#ea71dc15fac465788a27eb5f0e407b6d">bRotating</a> &amp;&amp; <a class="code" href="classsprite_object.html#b5e73e1a45286bf90ebadc81fc4d32d4">rotSetID</a> != -1)
<a name="l00394"></a>00394                         PA_SetRotsetNoZoom(<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#b5e73e1a45286bf90ebadc81fc4d32d4">rotSetID</a>, <a class="code" href="classsprite_object.html#ce33841bee3161423ef4240ed189bb59">rotAngle</a>);
<a name="l00395"></a>00395         }
<a name="l00396"></a>00396         <span class="keywordflow">if</span> (framesToLive &gt; -1)
<a name="l00397"></a>00397                 framesToLive--;
<a name="l00398"></a>00398 }
<a name="l00399"></a>00399 
<a name="l00410"></a><a class="code" href="classsprite_object.html#fb6a5f573a882b4fb81a551364442e5a">00410</a> <span class="keywordtype">void</span> <a class="code" href="classsprite_object.html#fb6a5f573a882b4fb81a551364442e5a">spriteObject::checkCollisions</a>(u8 indexToCheckFrom)
<a name="l00411"></a>00411 {
<a name="l00412"></a>00412         <span class="keywordflow">if</span> (!<a class="code" href="classsprite_object.html#cfa1e380339eb546e5b188e088e8b7ec">checkCollision</a>)
<a name="l00413"></a>00413                 <span class="keywordflow">return</span>;
<a name="l00414"></a>00414         <span class="keywordflow">for</span> (vector&lt;spriteObject*&gt;::iterator it = <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#8993fc24a621a318912564c3fe638149">gameSprites</a>.begin()+indexToCheckFrom; it != <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#8993fc24a621a318912564c3fe638149">gameSprites</a>.end(); ++it)
<a name="l00415"></a>00415         {
<a name="l00416"></a>00416                 <span class="keywordtype">bool</span> collides = <a class="code" href="classsprite_object.html#e58bcf114612b0cc8b932421d0511915">isColliding</a>(*it);
<a name="l00417"></a>00417                 
<a name="l00418"></a>00418                 <span class="keywordflow">if</span> (collides)
<a name="l00419"></a>00419                         <a class="code" href="classsprite_object.html#3b937e1e25e1602414d85eba7fd0f60c">collidingWith</a>(*it);
<a name="l00420"></a>00420                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!collides &amp;&amp; <a class="code" href="classsprite_object.html#643b09104ce81cf1aa1dd81b86f2ee8a">ignoreUntilUntouched</a> == *it)
<a name="l00421"></a>00421                 {
<a name="l00422"></a>00422                         <a class="code" href="classsprite_object.html#643b09104ce81cf1aa1dd81b86f2ee8a">ignoreUntilUntouched</a> = NULL;
<a name="l00423"></a>00423                 }
<a name="l00424"></a>00424         }
<a name="l00425"></a>00425 }
<a name="l00426"></a>00426 
<a name="l00435"></a><a class="code" href="classsprite_object.html#bb16c955048d0dab29e4b2dd29139822">00435</a> <span class="keywordtype">void</span> <a class="code" href="classsprite_object.html#bb16c955048d0dab29e4b2dd29139822">spriteObject::setTransparency</a>(u8 transLevel)
<a name="l00436"></a>00436 {
<a name="l00437"></a>00437         transLevel %= 15;       <span class="comment">//make sure it's in the proper range</span>
<a name="l00438"></a>00438         PA_SetSpriteMode(<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#9ecd48cc3420596c9a7a19cefcc8ee6e">spriteID</a>, 1);              <span class="comment">//turn alphablending on for this one</span>
<a name="l00439"></a>00439         <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#e25500efd83cb2764dfdd51c752487bc">setAlpha</a>(transLevel);
<a name="l00440"></a>00440 }
<a name="l00441"></a>00441 
<a name="l00446"></a><a class="code" href="classsprite_object.html#34689d0ec43caef2a63ace85ae8588ca">00446</a> <span class="keywordtype">void</span> <a class="code" href="classsprite_object.html#34689d0ec43caef2a63ace85ae8588ca">spriteObject::turnAround</a>()
<a name="l00447"></a>00447 {
<a name="l00448"></a>00448         <span class="comment">//shift slightly so that we move away from whatever made us turn around and stop it flipping again</span>
<a name="l00449"></a>00449         <a class="code" href="classsprite_object.html#4f1ae47c5993de56ed6e87dae90e3a8f">vx</a> &gt; 0 ? --<a class="code" href="classsprite_object.html#d32183242a6b4215f28535d42f7b9c3d">x</a> : ++<a class="code" href="classsprite_object.html#d32183242a6b4215f28535d42f7b9c3d">x</a>;
<a name="l00450"></a>00450         
<a name="l00451"></a>00451         <a class="code" href="classsprite_object.html#4f1ae47c5993de56ed6e87dae90e3a8f">vx</a> *= -1;
<a name="l00452"></a>00452         <a class="code" href="classsprite_object.html#9986cf3403d93accf99d23f2b73675b0">setFlipped</a>(!<a class="code" href="classsprite_object.html#ef3fdb67169b59c2893e887ed2560040">flippedh</a>, <a class="code" href="classsprite_object.html#f290204b7226bc2f9720161fc094a24b">flippedv</a>);
<a name="l00453"></a>00453 }
<a name="l00454"></a>00454 
<a name="l00461"></a><a class="code" href="classsprite_object.html#3e6eddf3bd7d5e921a5a30b1aa93a9b1">00461</a> <span class="keywordtype">bool</span> <a class="code" href="classsprite_object.html#3e6eddf3bd7d5e921a5a30b1aa93a9b1">spriteObject::isFacing</a>(<span class="keyword">const</span> <a class="code" href="classsprite_object.html">spriteObject</a> *other)<span class="keyword"> const</span>
<a name="l00462"></a>00462 <span class="keyword"></span>{
<a name="l00463"></a>00463         <span class="keywordflow">return</span> ((<a class="code" href="classsprite_object.html#7ec5aa5a7c47cc03647a3fefb14e9dc3">getx</a>() &gt; other-&gt;<a class="code" href="classsprite_object.html#7ec5aa5a7c47cc03647a3fefb14e9dc3">getx</a>() &amp;&amp; <a class="code" href="classsprite_object.html#ef3fdb67169b59c2893e887ed2560040">flippedh</a>) || 
<a name="l00464"></a>00464                         (<a class="code" href="classsprite_object.html#7ec5aa5a7c47cc03647a3fefb14e9dc3">getx</a>() &lt; other-&gt;<a class="code" href="classsprite_object.html#7ec5aa5a7c47cc03647a3fefb14e9dc3">getx</a>() &amp;&amp; !<a class="code" href="classsprite_object.html#ef3fdb67169b59c2893e887ed2560040">flippedh</a>));
<a name="l00465"></a>00465 }
<a name="l00475"></a><a class="code" href="classsprite_object.html#4d2f96da503f56d58066bbde7aec7689">00475</a> <span class="keywordtype">bool</span> <a class="code" href="classsprite_object.html#4d2f96da503f56d58066bbde7aec7689">spriteObject::inHorizPlaneOf</a>(<span class="keyword">const</span> <a class="code" href="classsprite_object.html">spriteObject</a> *other)<span class="keyword"> const</span>
<a name="l00476"></a>00476 <span class="keyword"></span>{
<a name="l00477"></a>00477         <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#3d87d4a36507fef44cc5d27f7d71d69f">isOver</a>(other)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00478"></a>00478     <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#d8119e064022fe65c846282dd8da2a48">isUnder</a>(other)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00479"></a>00479     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00480"></a>00480 }
<a name="l00490"></a><a class="code" href="classsprite_object.html#8fe8184212ca97ee6acd556ba4e00c38">00490</a> <span class="keywordtype">bool</span> <a class="code" href="classsprite_object.html#8fe8184212ca97ee6acd556ba4e00c38">spriteObject::inVertPlaneOf</a>(<span class="keyword">const</span> <a class="code" href="classsprite_object.html">spriteObject</a> *other)<span class="keyword"> const</span>
<a name="l00491"></a>00491 <span class="keyword"></span>{
<a name="l00492"></a>00492         <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#70f331d3537043eb5dc3009efda9bf0f">getRight</a>() &lt; other-&gt;<a class="code" href="classsprite_object.html#89af65012abe03e655deed758f01d716">getLeft</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00493"></a>00493     <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#89af65012abe03e655deed758f01d716">getLeft</a>() &gt; other-&gt;<a class="code" href="classsprite_object.html#70f331d3537043eb5dc3009efda9bf0f">getRight</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00494"></a>00494     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00495"></a>00495 }
<a name="l00502"></a><a class="code" href="classsprite_object.html#d8119e064022fe65c846282dd8da2a48">00502</a> <span class="keywordtype">bool</span> <a class="code" href="classsprite_object.html#d8119e064022fe65c846282dd8da2a48">spriteObject::isUnder</a>(<span class="keyword">const</span> <a class="code" href="classsprite_object.html">spriteObject</a> *other)<span class="keyword"> const</span>
<a name="l00503"></a>00503 <span class="keyword"></span>{
<a name="l00504"></a>00504     <span class="keywordflow">return</span> (<a class="code" href="classsprite_object.html#afea305006390da3d8544a2629a20742">getTop</a>() &gt; other-&gt;<a class="code" href="classsprite_object.html#097b5efb4a735e779de09aa9ad44cb32">getBottom</a>());
<a name="l00505"></a>00505 }
<a name="l00512"></a><a class="code" href="classsprite_object.html#3d87d4a36507fef44cc5d27f7d71d69f">00512</a> <span class="keywordtype">bool</span> <a class="code" href="classsprite_object.html#3d87d4a36507fef44cc5d27f7d71d69f">spriteObject::isOver</a>(<span class="keyword">const</span> <a class="code" href="classsprite_object.html">spriteObject</a> *other)<span class="keyword"> const</span>
<a name="l00513"></a>00513 <span class="keyword"></span>{
<a name="l00514"></a>00514     <span class="keywordflow">return</span> (<a class="code" href="classsprite_object.html#097b5efb4a735e779de09aa9ad44cb32">getBottom</a>() &lt; other-&gt;<a class="code" href="classsprite_object.html#afea305006390da3d8544a2629a20742">getTop</a>());
<a name="l00515"></a>00515 }
<a name="l00525"></a><a class="code" href="classsprite_object.html#d3ca319884738c38a81f410abefcc6d5">00525</a> <span class="keywordtype">bool</span> <a class="code" href="classsprite_object.html#d3ca319884738c38a81f410abefcc6d5">spriteObject::isStandingOn</a>(<span class="keyword">const</span> <a class="code" href="classsprite_object.html">spriteObject</a> *other)<span class="keyword"> const</span>
<a name="l00526"></a>00526 <span class="keyword"></span>{
<a name="l00527"></a>00527         <span class="keywordflow">if</span> (other == <span class="keyword">this</span>)
<a name="l00528"></a>00528                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00529"></a>00529         <span class="comment">//can only be based if falling downwards or stationary</span>
<a name="l00530"></a>00530         <span class="keywordflow">if</span> (other-&gt;<a class="code" href="classsprite_object.html#624130489f898677335b26ea6db35333">isBaseable</a>() &amp;&amp; <a class="code" href="classsprite_object.html#8fe8184212ca97ee6acd556ba4e00c38">inVertPlaneOf</a>(other) &amp;&amp; <a class="code" href="classsprite_object.html#097b5efb4a735e779de09aa9ad44cb32">getBottom</a>() == other-&gt;<a class="code" href="classsprite_object.html#afea305006390da3d8544a2629a20742">getTop</a>() &amp;&amp; <a class="code" href="classsprite_object.html#f4a9d82ef326b94b3719ea8e6b73664e">vy</a> &gt;= 0)
<a name="l00531"></a>00531                 <span class="keywordflow">return</span> <a class="code" href="classsprite_object.html#e58bcf114612b0cc8b932421d0511915">isColliding</a>(other, <span class="keyword">true</span>);
<a name="l00532"></a>00532         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00533"></a>00533 }
<a name="l00534"></a>00534 
<a name="l00542"></a><a class="code" href="classsprite_object.html#624130489f898677335b26ea6db35333">00542</a> <span class="keywordtype">bool</span> <a class="code" href="classsprite_object.html#624130489f898677335b26ea6db35333">spriteObject::isBaseable</a>()<span class="keyword"> const</span>
<a name="l00543"></a>00543 <span class="keyword"></span>{
<a name="l00544"></a>00544         <span class="keywordflow">return</span> (<a class="code" href="classsprite_object.html#3ae1bdb1e417477fa6aa7849993ff3a2">collision</a> &amp; <a class="code" href="classsprite_object.html#6b50b57ad715e840166471279ec510b4febd60a193fbf5489a24d47b68953896">COL_BASEABLE</a>);
<a name="l00545"></a>00545 }
<a name="l00546"></a>00546 
<a name="l00559"></a><a class="code" href="classsprite_object.html#e58bcf114612b0cc8b932421d0511915">00559</a> <span class="keywordtype">bool</span> <a class="code" href="classsprite_object.html#e58bcf114612b0cc8b932421d0511915">spriteObject::isColliding</a>(<span class="keyword">const</span> <a class="code" href="classsprite_object.html">spriteObject</a> *other, <span class="keywordtype">bool</span> checkReverse)<span class="keyword"> const</span>
<a name="l00560"></a>00560 <span class="keyword"></span>{       
<a name="l00561"></a>00561         <span class="keywordflow">if</span> (other == <span class="keyword">this</span> || other == <a class="code" href="classsprite_object.html#643b09104ce81cf1aa1dd81b86f2ee8a">ignoreUntilUntouched</a>)
<a name="l00562"></a>00562                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00563"></a>00563 
<a name="l00564"></a>00564         <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#3ae1bdb1e417477fa6aa7849993ff3a2">collision</a> == <a class="code" href="classsprite_object.html#6b50b57ad715e840166471279ec510b478bbbcd01f193c19402403395dc1d4d1">COL_NONE</a>)                                                                                              <span class="comment">//check for no collision</span>
<a name="l00565"></a>00565                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00566"></a>00566                 
<a name="l00567"></a>00567         <span class="keywordflow">if</span> (collision &lt;= COL_DOWNBASEABLE &amp;&amp; other-&gt;<a class="code" href="classsprite_object.html#097b5efb4a735e779de09aa9ad44cb32">getBottom</a>() != <a class="code" href="classsprite_object.html#afea305006390da3d8544a2629a20742">getTop</a>())    <span class="comment">//check for down-only collision</span>
<a name="l00568"></a>00568                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00569"></a>00569 
<a name="l00570"></a>00570         <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#3ae1bdb1e417477fa6aa7849993ff3a2">collision</a> == <a class="code" href="classsprite_object.html#6b50b57ad715e840166471279ec510b466c7c5ecc100a6f04b4cdf5e8467f1a3">COL_CENTERPOINT</a> &amp;&amp;                                                                             <span class="comment">//check for centerpoint collision</span>
<a name="l00571"></a>00571                  (<a class="code" href="classsprite_object.html#7ec5aa5a7c47cc03647a3fefb14e9dc3">getx</a>() &lt; other-&gt;<a class="code" href="classsprite_object.html#70f331d3537043eb5dc3009efda9bf0f">getRight</a>() &amp;&amp; <a class="code" href="classsprite_object.html#7ec5aa5a7c47cc03647a3fefb14e9dc3">getx</a>() &gt; other-&gt;<a class="code" href="classsprite_object.html#89af65012abe03e655deed758f01d716">getLeft</a>() &amp;&amp; 
<a name="l00572"></a>00572                         <a class="code" href="classsprite_object.html#6e21a79795265fbba9cc63ea056e7bb1">gety</a>() &lt; other-&gt;<a class="code" href="classsprite_object.html#097b5efb4a735e779de09aa9ad44cb32">getBottom</a>() &amp;&amp; <a class="code" href="classsprite_object.html#6e21a79795265fbba9cc63ea056e7bb1">gety</a>() &gt; other-&gt;<a class="code" href="classsprite_object.html#afea305006390da3d8544a2629a20742">getTop</a>()))
<a name="l00573"></a>00573                 <span class="keywordflow">return</span> (!checkReverse || other-&gt;<a class="code" href="classsprite_object.html#e58bcf114612b0cc8b932421d0511915">isColliding</a>(<span class="keyword">this</span>, <span class="keyword">false</span>));
<a name="l00574"></a>00574         
<a name="l00575"></a>00575         <span class="keywordflow">if</span> (!<a class="code" href="classsprite_object.html#4d2f96da503f56d58066bbde7aec7689">inHorizPlaneOf</a>(other)) <span class="keywordflow">return</span> <span class="keyword">false</span>;                                                               <span class="comment">//check for solid collision</span>
<a name="l00576"></a>00576         <span class="keywordflow">if</span> (!<a class="code" href="classsprite_object.html#8fe8184212ca97ee6acd556ba4e00c38">inVertPlaneOf</a>(other)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00577"></a>00577 
<a name="l00578"></a>00578         <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#3ae1bdb1e417477fa6aa7849993ff3a2">collision</a> != <a class="code" href="classsprite_object.html#6b50b57ad715e840166471279ec510b4d92790e1904235edd2d3f597307cdb9b">COL_PIXELPERFECT</a>)
<a name="l00579"></a>00579                 <span class="keywordflow">return</span> (!checkReverse || other-&gt;<a class="code" href="classsprite_object.html#e58bcf114612b0cc8b932421d0511915">isColliding</a>(<span class="keyword">this</span>, <span class="keyword">false</span>));
<a name="l00580"></a>00580         
<a name="l00587"></a>00587         s32 over_bottom, over_top, over_left, over_right, over_width, over_height;
<a name="l00588"></a>00588         s32 startSearch1, startSearch2, startSearchOffset1, startSearchOffset2;
<a name="l00589"></a>00589     
<a name="l00590"></a>00590     <span class="comment">//still not ruled out, so compute area of overlap</span>
<a name="l00591"></a>00591     <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#097b5efb4a735e779de09aa9ad44cb32">getBottom</a>() &gt; other-&gt;<a class="code" href="classsprite_object.html#097b5efb4a735e779de09aa9ad44cb32">getBottom</a>())
<a name="l00592"></a>00592         over_bottom = other-&gt;<a class="code" href="classsprite_object.html#097b5efb4a735e779de09aa9ad44cb32">getBottom</a>();
<a name="l00593"></a>00593     <span class="keywordflow">else</span>
<a name="l00594"></a>00594         over_bottom = <a class="code" href="classsprite_object.html#097b5efb4a735e779de09aa9ad44cb32">getBottom</a>();
<a name="l00595"></a>00595     <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#afea305006390da3d8544a2629a20742">getTop</a>() &lt; other-&gt;<a class="code" href="classsprite_object.html#afea305006390da3d8544a2629a20742">getTop</a>())
<a name="l00596"></a>00596         over_top = other-&gt;<a class="code" href="classsprite_object.html#afea305006390da3d8544a2629a20742">getTop</a>();
<a name="l00597"></a>00597     <span class="keywordflow">else</span>
<a name="l00598"></a>00598         over_top = <a class="code" href="classsprite_object.html#afea305006390da3d8544a2629a20742">getTop</a>();
<a name="l00599"></a>00599     <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#70f331d3537043eb5dc3009efda9bf0f">getRight</a>() &gt; other-&gt;<a class="code" href="classsprite_object.html#70f331d3537043eb5dc3009efda9bf0f">getRight</a>())
<a name="l00600"></a>00600         over_right = other-&gt;<a class="code" href="classsprite_object.html#70f331d3537043eb5dc3009efda9bf0f">getRight</a>();
<a name="l00601"></a>00601     <span class="keywordflow">else</span>
<a name="l00602"></a>00602         over_right = <a class="code" href="classsprite_object.html#70f331d3537043eb5dc3009efda9bf0f">getRight</a>();
<a name="l00603"></a>00603     <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#89af65012abe03e655deed758f01d716">getLeft</a>() &lt; other-&gt;<a class="code" href="classsprite_object.html#89af65012abe03e655deed758f01d716">getLeft</a>())
<a name="l00604"></a>00604         over_left = other-&gt;<a class="code" href="classsprite_object.html#89af65012abe03e655deed758f01d716">getLeft</a>();
<a name="l00605"></a>00605     <span class="keywordflow">else</span>
<a name="l00606"></a>00606         over_left = <a class="code" href="classsprite_object.html#89af65012abe03e655deed758f01d716">getLeft</a>();
<a name="l00607"></a>00607 
<a name="l00608"></a>00608     over_width = over_right - over_left;
<a name="l00609"></a>00609     over_height = over_bottom - over_top;
<a name="l00610"></a>00610     
<a name="l00611"></a>00611     <span class="comment">// Now compute starting offsets into both objects' bitmaps:</span>
<a name="l00612"></a>00612     startSearchOffset1 = <a class="code" href="classsprite_object.html#3d250c9ad97a81b5dbeef79991eea9e7">frame</a> * <a class="code" href="classsprite_object.html#8a42d1e5ef00fb1968eda24bbc5e05d5">centerx</a>*2 * <a class="code" href="classsprite_object.html#370dd17954cde6b12ec0469f03827d6f">centery</a>*2;
<a name="l00613"></a>00613     startSearchOffset2 = other-&gt;<a class="code" href="classsprite_object.html#3d250c9ad97a81b5dbeef79991eea9e7">frame</a> * other-&gt;<a class="code" href="classsprite_object.html#8a42d1e5ef00fb1968eda24bbc5e05d5">centerx</a>*2 * other-&gt;<a class="code" href="classsprite_object.html#370dd17954cde6b12ec0469f03827d6f">centery</a>*2;
<a name="l00614"></a>00614         
<a name="l00615"></a>00615         <span class="comment">//retrieve GFX data from registers</span>
<a name="l00616"></a>00616         <span class="comment">//TODO: will possibly run outside of bounds when searching. How to check max length?</span>
<a name="l00617"></a>00617         u16* myGFX = PA_SpriteAnimP[<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>][<a class="code" href="classsprite_object.html#a0148bc6ed77ecec3054fba6b84edef4">getGFXid</a>()];
<a name="l00618"></a>00618         u16* otherGFX = PA_SpriteAnimP[other-&gt;<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>][other-&gt;<a class="code" href="classsprite_object.html#a0148bc6ed77ecec3054fba6b84edef4">getGFXid</a>()];
<a name="l00619"></a>00619     
<a name="l00620"></a>00620     <span class="comment">//the insaneo logic here is to not forget that the sprite may be flipped (the data isnt!)</span>
<a name="l00621"></a>00621     <span class="comment">//and also that the bounds are smaller than the actual sprite (so borders must be added)</span>
<a name="l00622"></a>00622     <span class="comment">//TODO: check that this actually works properly when sprites are flipped.</span>
<a name="l00623"></a>00623     startSearch1 = startSearchOffset1 + (over_top - (<a class="code" href="classsprite_object.html#51a72aa5cf4648b3d142431b46c46247">y</a>&gt;&gt;8) * <a class="code" href="classsprite_object.html#8a42d1e5ef00fb1968eda24bbc5e05d5">centerx</a>*2) + (over_left - (<a class="code" href="classsprite_object.html#d32183242a6b4215f28535d42f7b9c3d">x</a>&gt;&gt;8));
<a name="l00624"></a>00624     startSearch2 = startSearchOffset2 + (over_top - (other-&gt;<a class="code" href="classsprite_object.html#51a72aa5cf4648b3d142431b46c46247">y</a>&gt;&gt;8) * other-&gt;<a class="code" href="classsprite_object.html#8a42d1e5ef00fb1968eda24bbc5e05d5">centerx</a>*2) + (over_left - (other-&gt;<a class="code" href="classsprite_object.html#d32183242a6b4215f28535d42f7b9c3d">x</a>&gt;&gt;8));    
<a name="l00625"></a>00625     <span class="comment">//still not ruled out, so scan through intersecting rectangle to find pixels that are the same.</span>
<a name="l00626"></a>00626     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; over_height; ++i)
<a name="l00627"></a>00627     {
<a name="l00628"></a>00628         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j &lt; over_width; ++j)
<a name="l00629"></a>00629         {              
<a name="l00630"></a>00630             <span class="keywordflow">if</span> (myGFX[startSearch1] &gt; 0 &amp;&amp; otherGFX[startSearch2] &gt; 0)
<a name="l00631"></a>00631                 <span class="keywordflow">return</span> (!checkReverse || other-&gt;<a class="code" href="classsprite_object.html#e58bcf114612b0cc8b932421d0511915">isColliding</a>(<span class="keyword">this</span>, <span class="keyword">false</span>));
<a name="l00632"></a>00632             ++startSearch1;
<a name="l00633"></a>00633             ++startSearch2;
<a name="l00634"></a>00634         }
<a name="l00635"></a>00635         startSearch1 += (<a class="code" href="classsprite_object.html#8a42d1e5ef00fb1968eda24bbc5e05d5">centerx</a>*2 - over_width);
<a name="l00636"></a>00636         startSearch2 += (other-&gt;<a class="code" href="classsprite_object.html#8a42d1e5ef00fb1968eda24bbc5e05d5">centerx</a>*2 - over_width);
<a name="l00637"></a>00637     }
<a name="l00638"></a>00638     <span class="comment">//searched through all pixels and no match. Bit of a waste of time, really.</span>
<a name="l00639"></a>00639     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00640"></a>00640 }
<a name="l00641"></a>00641 
<a name="l00648"></a><a class="code" href="classsprite_object.html#9986cf3403d93accf99d23f2b73675b0">00648</a> <span class="keywordtype">void</span> <a class="code" href="classsprite_object.html#9986cf3403d93accf99d23f2b73675b0">spriteObject::setFlipped</a>(<span class="keywordtype">bool</span> fh, <span class="keywordtype">bool</span> fv)
<a name="l00649"></a>00649 {
<a name="l00650"></a>00650         <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#ea71dc15fac465788a27eb5f0e407b6d">bRotating</a> &amp;&amp; <a class="code" href="classsprite_object.html#b5e73e1a45286bf90ebadc81fc4d32d4">rotSetID</a> != -1)        <span class="comment">//cant be flipped if rotating at the same time</span>
<a name="l00651"></a>00651                 <span class="keywordflow">return</span>;
<a name="l00652"></a>00652         
<a name="l00653"></a>00653         <a class="code" href="classsprite_object.html#ef3fdb67169b59c2893e887ed2560040">flippedh</a> = fh;
<a name="l00654"></a>00654         <a class="code" href="classsprite_object.html#f290204b7226bc2f9720161fc094a24b">flippedv</a> = fv;
<a name="l00655"></a>00655         <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#4f65a615dbbfe356a6dd80d646df11e3">oldFliph</a> != <a class="code" href="classsprite_object.html#ef3fdb67169b59c2893e887ed2560040">flippedh</a>)
<a name="l00656"></a>00656         {
<a name="l00657"></a>00657                 <a class="code" href="classsprite_object.html#2affc5517130f041436591cd266dc7ce">swapHBounds</a>();
<a name="l00658"></a>00658                 <a class="code" href="classsprite_object.html#4f65a615dbbfe356a6dd80d646df11e3">oldFliph</a> = <a class="code" href="classsprite_object.html#ef3fdb67169b59c2893e887ed2560040">flippedh</a>;
<a name="l00659"></a>00659         }
<a name="l00660"></a>00660         <span class="keywordflow">if</span> (<a class="code" href="classsprite_object.html#de57316618f94deb5ac15dbb1c035399">oldFlipv</a> != <a class="code" href="classsprite_object.html#f290204b7226bc2f9720161fc094a24b">flippedv</a>)
<a name="l00661"></a>00661         {
<a name="l00662"></a>00662                 <a class="code" href="classsprite_object.html#d8ede14db035f952bfce91b77019a157">swapVBounds</a>();
<a name="l00663"></a>00663                 <a class="code" href="classsprite_object.html#de57316618f94deb5ac15dbb1c035399">oldFlipv</a> = <a class="code" href="classsprite_object.html#f290204b7226bc2f9720161fc094a24b">flippedv</a>;
<a name="l00664"></a>00664         }
<a name="l00665"></a>00665         <a class="code" href="classsprite_object.html#a66c224f6865cffffef4117e769808d8">UPDATEDflip</a> = <span class="keyword">true</span>;
<a name="l00666"></a>00666 }
<a name="l00667"></a>00667 
<a name="l00668"></a>00668 <span class="preprocessor">#ifdef __WITHSOUND</span>
<a name="l00669"></a>00669 <span class="preprocessor"></span>
<a name="l00678"></a><a class="code" href="classsprite_object.html#4c8368e728c4b96fa6823287cb4f3e49">00678</a> <span class="keywordtype">void</span> <a class="code" href="classsprite_object.html#4c8368e728c4b96fa6823287cb4f3e49">spriteObject::playSound</a>(<span class="keyword">const</span> u8 *sound, <span class="keyword">const</span> u32 *size, <span class="keywordtype">bool</span> repeat, u8 vol)
<a name="l00679"></a>00679 {
<a name="l00680"></a>00680         <a class="code" href="classsprite_object.html#5459b17a49c6e423038c7178ab4a6dd0">stopSound</a>();
<a name="l00681"></a>00681         <a class="code" href="classsprite_object.html#c715f5489bfb7f229334eec5bbe1ae10">setSoundChannel</a>(<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#6015f22da708fec86576c5009716631c">playSound</a>(sound, size, repeat, vol));
<a name="l00682"></a>00682 <span class="preprocessor">        #ifdef __MDDEBUG</span>
<a name="l00683"></a>00683 <span class="preprocessor"></span>        <span class="keywordtype">char</span> buffer[255];
<a name="l00684"></a>00684         sprintf(buffer, <span class="stringliteral">"%d: sound playing (channel %d, raw)"</span>, <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#f6341f61a964f1f782d4e66a0d398dd0">soundChannel</a>);
<a name="l00685"></a>00685         macros::debugMessage(className, buffer);
<a name="l00686"></a>00686 <span class="preprocessor">        #endif</span>
<a name="l00687"></a>00687 <span class="preprocessor"></span>}
<a name="l00688"></a>00688 
<a name="l00697"></a><a class="code" href="classsprite_object.html#71ac7215310c178424e6a8cd6d283f9e">00697</a> <span class="keywordtype">void</span> <a class="code" href="classsprite_object.html#4c8368e728c4b96fa6823287cb4f3e49">spriteObject::playSound</a>(<a class="code" href="structsprite_manager_1_1sound_data.html">spriteManager::soundData</a> *sound, <span class="keywordtype">bool</span> repeat, u8 vol)
<a name="l00698"></a>00698 {
<a name="l00699"></a>00699         <a class="code" href="classsprite_object.html#5459b17a49c6e423038c7178ab4a6dd0">stopSound</a>();
<a name="l00700"></a>00700         <a class="code" href="classsprite_object.html#c715f5489bfb7f229334eec5bbe1ae10">setSoundChannel</a>(<a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#6015f22da708fec86576c5009716631c">playSound</a>(sound-&gt;<a class="code" href="structsprite_manager_1_1sound_data.html#4e4cd6d71c33e09f31031cf0259ae554">data</a>, sound-&gt;<a class="code" href="structsprite_manager_1_1sound_data.html#e817fc89fa227d41f4626cfa3d87c2ca">size</a>, repeat, vol));
<a name="l00701"></a>00701 <span class="preprocessor">        #ifdef __MDDEBUG</span>
<a name="l00702"></a>00702 <span class="preprocessor"></span>        <span class="keywordtype">char</span> buffer[255];
<a name="l00703"></a>00703         sprintf(buffer, <span class="stringliteral">"%d: sound playing (channel %d, soundData)"</span>, <a class="code" href="classsprite_object.html#91226a9f4208c1962119821fa8ed3b94">sm</a>-&gt;<a class="code" href="classsprite_manager.html#64676e05909abf6eff7f6edfbe02ed93">screen</a>, <a class="code" href="classsprite_object.html#f6341f61a964f1f782d4e66a0d398dd0">soundChannel</a>);
<a name="l00704"></a>00704         macros::debugMessage(className, buffer);
<a name="l00705"></a>00705 <span class="preprocessor">        #endif</span>
<a name="l00706"></a>00706 <span class="preprocessor"></span>}
<a name="l00707"></a>00707 <span class="preprocessor">#endif</span>
<a name="l00708"></a>00708 <span class="preprocessor"></span>
<a name="l00719"></a><a class="code" href="classsprite_object.html#dacf67300dd0b7d4e3dce1ad2e9bbce5">00719</a> <span class="keywordtype">void</span> <a class="code" href="classsprite_object.html#dacf67300dd0b7d4e3dce1ad2e9bbce5">spriteObject::setParent</a>(<a class="code" href="classsprite_object.html">spriteObject</a> *other)
<a name="l00720"></a>00720 {
<a name="l00721"></a>00721         <a class="code" href="classsprite_object.html#1ebc3125aa8da5949e3119025f6fbc2f">parentSprite</a> = other;
<a name="l00722"></a>00722 }
<a name="l00723"></a>00723 
<a name="l00736"></a><a class="code" href="classsprite_object.html#388c7a06fe42d6844be47023156d17be">00736</a> <span class="keywordtype">void</span> <a class="code" href="classsprite_object.html#388c7a06fe42d6844be47023156d17be">spriteObject::addChild</a>(<a class="code" href="classsprite_object.html">spriteObject</a> *other)
<a name="l00737"></a>00737 {
<a name="l00738"></a>00738         <span class="keywordflow">if</span> (other != NULL)
<a name="l00739"></a>00739         {
<a name="l00740"></a>00740                 <a class="code" href="classsprite_object.html#7dcea86f2e14b1bbe8742a9a8d1211ea">childSprite</a> = other;
<a name="l00741"></a>00741                 <span class="comment">//childSprites.push_back(other);</span>
<a name="l00742"></a>00742                 other-&gt;<a class="code" href="classsprite_object.html#dacf67300dd0b7d4e3dce1ad2e9bbce5">setParent</a>(<span class="keyword">this</span>);
<a name="l00743"></a>00743         }
<a name="l00744"></a>00744 <span class="preprocessor">        #ifdef __MDDEBUG</span>
<a name="l00745"></a>00745 <span class="preprocessor"></span>        <span class="keywordflow">else</span>
<a name="l00746"></a>00746                 macros::debugMessage(ERRTEXT, <span class="stringliteral">"NULL childSprite added"</span>, ERRORPOS);
<a name="l00747"></a>00747 <span class="preprocessor">        #endif</span>
<a name="l00748"></a>00748 <span class="preprocessor"></span>}
<a name="l00749"></a>00749 
<a name="l00756"></a><a class="code" href="classsprite_object.html#b9a4353f4fd14c7fa5b9aaa0348d29d7">00756</a> <span class="keywordtype">bool</span> <a class="code" href="classsprite_object.html#b9a4353f4fd14c7fa5b9aaa0348d29d7">spriteObject::removeChild</a>(<span class="comment">/*spriteObject *other*/</span>)
<a name="l00757"></a>00757 {
<a name="l00758"></a>00758         <span class="comment">/*u8 childID = 0;</span>
<a name="l00759"></a>00759 <span class="comment">        bool bFound = false;</span>
<a name="l00760"></a>00760 <span class="comment">        for (unsigned int i=0; i&lt;childSprites.size(); ++i)</span>
<a name="l00761"></a>00761 <span class="comment">        {</span>
<a name="l00762"></a>00762 <span class="comment">                if (childSprites[i] == other)</span>
<a name="l00763"></a>00763 <span class="comment">                {</span>
<a name="l00764"></a>00764 <span class="comment">                        childSprites[i]-&gt;parentSprite = NULL;</span>
<a name="l00765"></a>00765 <span class="comment">                        childID = i;</span>
<a name="l00766"></a>00766 <span class="comment">                        bFound = true;</span>
<a name="l00767"></a>00767 <span class="comment">                        break;</span>
<a name="l00768"></a>00768 <span class="comment">                }</span>
<a name="l00769"></a>00769 <span class="comment">        }</span>
<a name="l00770"></a>00770 <span class="comment">        if (bFound)</span>
<a name="l00771"></a>00771 <span class="comment">                childSprites.erase(childSprites.begin()+childID, childSprites.begin()+childID+1);</span>
<a name="l00772"></a>00772 <span class="comment">        #ifdef __MDDEBUG</span>
<a name="l00773"></a>00773 <span class="comment">        else macros::debugMessage(ERRTEXT, "Removed invalid child sprite", ERRORPOS);</span>
<a name="l00774"></a>00774 <span class="comment">        #endif</span>
<a name="l00775"></a>00775 <span class="comment">        return bFound;*/</span>
<a name="l00776"></a>00776         <a class="code" href="classsprite_object.html#7dcea86f2e14b1bbe8742a9a8d1211ea">childSprite</a> = NULL;
<a name="l00777"></a>00777         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00778"></a>00778 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Tue Mar 13 23:27:53 2007 for MDuel DS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1-p1 </small></address>
</body>
</html>
